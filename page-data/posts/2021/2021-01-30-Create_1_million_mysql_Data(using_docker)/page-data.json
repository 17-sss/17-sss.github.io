{
    "componentChunkName": "component---src-pages-custom-post-tsx",
    "path": "/posts/2021/2021-01-30-Create_1_million_mysql_Data(using_docker)/",
    "result": {"data":{"allMarkdownRemark":{"edges":[{"node":{"id":"ddc0032e-f7c8-5122-b60b-6849752943bb","fields":{"slug":"/2021/2021-01-30-Create_1_million_mysql_Data(using_docker)/"},"html":"<h1>MySQL 데이터 만들기 (Docker 활용)</h1>\n<h2>1. 유저 생성 &#x26; 권한 설정</h2>\n<p>먼저 Docker의 MySQL에 접속한 후.</p>\n<h3>데이터베이스 생성</h3>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">USER</span> <span class=\"token string\">'rano'</span><span class=\"token variable\">@'%'</span> IDENTIFIED <span class=\"token keyword\">BY</span> <span class=\"token string\">'passwd'</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">-- 유저명 &amp; 비번 설정</span>\n<span class=\"token keyword\">GRANT</span> <span class=\"token keyword\">ALL</span> <span class=\"token keyword\">ON</span> testdb<span class=\"token punctuation\">.</span><span class=\"token operator\">*</span> <span class=\"token keyword\">TO</span> <span class=\"token string\">'rano'</span><span class=\"token variable\">@'%'</span><span class=\"token punctuation\">;</span>            <span class=\"token comment\">-- 권한 설정</span>\nFLUSH <span class=\"token keyword\">PRIVILEGES</span><span class=\"token punctuation\">;</span></code></pre></div>\n<br/>\n<h2>2. DB 생성 및 100만개 데이터 생성</h2>\n<p><strong>순서대로 하기!</strong></p>\n<h3>1) DATABASE 생성</h3>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">DATABASE</span> testdb<span class=\"token punctuation\">;</span> <span class=\"token comment\">-- testdb라는 DATABASE 생성</span>\n<span class=\"token keyword\">SHOW</span> <span class=\"token keyword\">DATABASES</span><span class=\"token punctuation\">;</span>         <span class=\"token comment\">-- 아래 사진처럼 DATABASE 리스트 나옴</span></code></pre></div>\n<p><img src=\"https://user-images.githubusercontent.com/33610315/106299198-3e050700-6298-11eb-87f1-0b380dc3ddf9.png\" alt=\"image\"></p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">use</span> testdb<span class=\"token punctuation\">;</span> <span class=\"token comment\">-- 꼭 use할 DATABASE 입력하고 테이블 생성해야함!</span></code></pre></div>\n<h3>2) 영단어 100개를 넣을 word_onehundred 테이블 생성</h3>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TABLE</span> word_onehundred <span class=\"token punctuation\">(</span>\n\tid <span class=\"token keyword\">int</span> <span class=\"token keyword\">auto_increment</span> <span class=\"token keyword\">primary</span> <span class=\"token keyword\">key</span><span class=\"token punctuation\">,</span>\n    word <span class=\"token keyword\">VARCHAR</span><span class=\"token punctuation\">(</span><span class=\"token number\">50</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> word_onehundred <span class=\"token punctuation\">(</span>word<span class=\"token punctuation\">)</span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'wage'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">-- 이런식으로 100개 넣어주기.</span></code></pre></div>\n<p><img src=\"https://user-images.githubusercontent.com/33610315/106301538-29763e00-629b-11eb-816e-fdd98deb40ef.png\" alt=\"image\"><br>\n<img src=\"https://user-images.githubusercontent.com/33610315/106301376-fa5fcc80-629a-11eb-8658-b18f235a08bd.png\" alt=\"image\"></p>\n<h3>3) user_log 테이블 생성</h3>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TABLE</span> user_log <span class=\"token punctuation\">(</span>\n\tid <span class=\"token keyword\">int</span> <span class=\"token keyword\">auto_increment</span> <span class=\"token keyword\">primary</span> <span class=\"token keyword\">key</span><span class=\"token punctuation\">,</span>\n\tnickname <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">64</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n\tmoney <span class=\"token keyword\">dec</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    last_visit <span class=\"token keyword\">datetime</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<ul>\n<li>id 필드의 옵션 2가지.\n<ul>\n<li>primary key: 테이블내에 있는 데이터를 식별함 (기본 키 지정)</li>\n<li>auto_increment: 위 id 필드는 이 옵션을 써주면 id가 추가될 때마다 1씩 값이 증가되어 자동으로 들어간다.</li>\n</ul>\n</li>\n</ul>\n<h3>4) 생성된 테이블에 100만개 임의의 데이터 Insert. (프로시저 생성)</h3>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">DELIMITER</span> $$\n<span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">PROCEDURE</span> generate_data<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">BEGIN</span>\n  <span class=\"token keyword\">DECLARE</span> i <span class=\"token keyword\">INT</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">DECLARE</span> a <span class=\"token keyword\">INT</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">DECLARE</span> b <span class=\"token keyword\">INT</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">DECLARE</span> c <span class=\"token keyword\">INT</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">DECLARE</span> numFour <span class=\"token keyword\">INT</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">DECLARE</span> datetmp <span class=\"token keyword\">datetime</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">WHILE</span> i <span class=\"token operator\">&lt;</span> <span class=\"token number\">1000000</span> <span class=\"token keyword\">DO</span>\n\t<span class=\"token keyword\">SET</span> a <span class=\"token operator\">=</span> FLOOR<span class=\"token punctuation\">(</span><span class=\"token number\">65</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>RAND<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">25</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  <span class=\"token keyword\">SET</span> b <span class=\"token operator\">=</span> FLOOR<span class=\"token punctuation\">(</span><span class=\"token number\">65</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>RAND<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">25</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  <span class=\"token keyword\">SET</span> c <span class=\"token operator\">=</span> FLOOR<span class=\"token punctuation\">(</span><span class=\"token number\">65</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>RAND<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">25</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  <span class=\"token keyword\">SET</span> numFour <span class=\"token operator\">=</span> FLOOR<span class=\"token punctuation\">(</span><span class=\"token number\">1000</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>RAND<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">8999</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">SET</span> datetmp <span class=\"token operator\">=</span> FROM_UNIXTIME<span class=\"token punctuation\">(</span>FLOOR<span class=\"token punctuation\">(</span>unix_timestamp<span class=\"token punctuation\">(</span><span class=\"token string\">'2020-12-31 00:00:00'</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span>RAND<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>unix_timestamp<span class=\"token punctuation\">(</span><span class=\"token string\">'2021-01-29 00:00:00'</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span>unix_timestamp<span class=\"token punctuation\">(</span><span class=\"token string\">'2020-12-31 00:00:00'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> user_log <span class=\"token punctuation\">(</span> nickname<span class=\"token punctuation\">,</span> money<span class=\"token punctuation\">,</span> last_visit <span class=\"token punctuation\">)</span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span>\n\t\tconcat<span class=\"token punctuation\">(</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">SELECT</span> word <span class=\"token keyword\">FROM</span> word_onehundred <span class=\"token keyword\">order</span> <span class=\"token keyword\">by</span> rand<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">limit</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'_'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">char</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">char</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">char</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> numFour <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">(</span><span class=\"token keyword\">SELECT</span> <span class=\"token punctuation\">(</span>FLOOR<span class=\"token punctuation\">(</span>RAND<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">100000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n\t\tdatetmp\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">SET</span> i <span class=\"token operator\">=</span> i <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">-- 10000개의 데이터가 들어갈 때마다 COMMIT.</span>\n    <span class=\"token keyword\">IF</span> <span class=\"token punctuation\">(</span>i <span class=\"token operator\">%</span> <span class=\"token number\">10000</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">THEN</span>\n\t\t<span class=\"token keyword\">COMMIT</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">END</span> <span class=\"token keyword\">IF</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">END</span> <span class=\"token keyword\">WHILE</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">END</span>$$\n<span class=\"token keyword\">DELIMITER</span> <span class=\"token punctuation\">;</span></code></pre></div>\n<ul>\n<li>꼭 기본으로 설정되어 있는 AUTOCOMMIT을 꺼준다. 안끄고 실행하면 진짜.. 시간..</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">SET</span> AUTOCOMMIT <span class=\"token operator\">=</span> <span class=\"token boolean\">FALSE</span><span class=\"token punctuation\">;</span></code></pre></div>\n<ul>\n<li>프로시저 실행.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">call</span> generate_data<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<ul>\n<li>\n<p>들어간 데이터 확인<br>\n<img src=\"https://user-images.githubusercontent.com/33610315/106300879-57a74e00-629a-11eb-806e-ba1a9870f9f6.png\" alt=\"image\"><br>\n<img src=\"https://user-images.githubusercontent.com/33610315/106300723-2cbcfa00-629a-11eb-9697-8f580b94fa84.png\" alt=\"image\"><br>\n<img src=\"https://user-images.githubusercontent.com/33610315/106303999-2466be00-629e-11eb-86b8-334e8d8402fd.png\" alt=\"image\"></p>\n</li>\n<li>\n<p>206초 걸린것도 뿌듯하지만 나중에 <em>Bulk Insert</em> 한번 해보기!</p>\n</li>\n</ul>\n<hr>\n<h3><strong>참고 링크</strong></h3>\n<ul>\n<li><a href=\"https://m.blog.naver.com/cec7777/221722327481\" target=\"_blank\" rel=\"nofollow\">MYSQL Stored Procedure 완벽정리</a></li>\n<li><a href=\"https://stackoverflow.com/questions/25098747/how-to-generate-1000000-rows-with-random-data/25099275\" target=\"_blank\" rel=\"nofollow\">Stack Overflow 사이트 - 100만개 데이터 생성 시 참고</a></li>\n</ul>","frontmatter":{"title":"[Database] MySQL 데이터 만들기 (Docker 활용)","summary":null,"date":"2021.01.30.","categories":["Database"],"options":null,"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAIAAAAC64paAAAACXBIWXMAAAsTAAALEwEAmpwYAAABc0lEQVQ4y+1TTUsCQRjef9m1cxBBBR3DQwTZuUPhpfDSIegDQ0NNVlMWgySzdTU/Wtev1G1N192ZnfcNP1CxpbI6NpcZnplnnud93hkOfzG47xxiAAA/IlM2YsK8ZAuAzyt8XlG0znzKQ8G7cj1ZbfI5RXpRByDMYVvVDbHeQkSfVOwSaq/MoF8VwFQ4wBAZsdhRPKn1jGJLixTKX9geXTGFSBotvRFE9Gfl4FNpbJ4bx+iTipphxuVaZlgboiXzVjkGnQqKbtZ4QDVdfVXFwe6s8oLb4xKSK6fXm76bRKXJZ7L61TI0RZI4oM9BI+IgsW2k+nTXuOHcNswtv7B47N3whHdDt+vnob3oPWrprn/NCKyC3jAFpxlxAOnCx5pV3bgU84fx1EUq500Xlk4C4ZyMtaiRcNHMGRF2TMFJEvv0yQNaAcGyCWyYUq6leR7z/RXpAO31cbMNvSYyE6mOjE5sz+Rsk73ts/68VX/2q/7JE/I74CSFtPwKC98AAAAASUVORK5CYII="},"images":{"fallback":{"src":"/static/2a209ce852c1335e7a777a7871c2e4e8/5f2c3/background_mysql.png","srcSet":"/static/2a209ce852c1335e7a777a7871c2e4e8/90cd3/background_mysql.png 100w,\n/static/2a209ce852c1335e7a777a7871c2e4e8/614dc/background_mysql.png 200w,\n/static/2a209ce852c1335e7a777a7871c2e4e8/5f2c3/background_mysql.png 400w","sizes":"(min-width: 400px) 400px, 100vw"},"sources":[{"srcSet":"/static/2a209ce852c1335e7a777a7871c2e4e8/e64f1/background_mysql.webp 100w,\n/static/2a209ce852c1335e7a777a7871c2e4e8/8b00d/background_mysql.webp 200w,\n/static/2a209ce852c1335e7a777a7871c2e4e8/9c0a1/background_mysql.webp 400w","type":"image/webp","sizes":"(min-width: 400px) 400px, 100vw"}]},"width":400,"height":400}},"publicURL":"/static/2a209ce852c1335e7a777a7871c2e4e8/background_mysql.png"}}}}]}},"pageContext":{"slug":"/2021/2021-01-30-Create_1_million_mysql_Data(using_docker)/"}},
    "staticQueryHashes": ["1642645631","2183628444","3590156278","363963755","3949884163","77750267","884297919"]}