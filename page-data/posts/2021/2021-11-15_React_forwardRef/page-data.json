{
    "componentChunkName": "component---src-pages-custom-post-tsx",
    "path": "/posts/2021/2021-11-15_React_forwardRef/",
    "result": {"data":{"allMarkdownRemark":{"edges":[{"node":{"id":"ae985f1d-0308-52df-a059-242501d55bf4","fields":{"slug":"/2021/2021-11-15_React_forwardRef/"},"html":"<h2>🤔 forwardRef가 뭘까</h2>\n<h3>1. 사용하기 전에, 이건 왜 사용해야 할까?</h3>\n<ul>\n<li>리액트의 컴포넌트는 캡슐화의 특징을 가지고 있다.<br>\n컴포넌트 자체의 응집도를 높이고 의존도를 낮추기 위해 캡슐화.</li>\n<li>캡슐화를 통해 컴포넌트의 내부 로직이나 상태는 노출되지 않는다.</li>\n<li>일반적으로 사용하는 쪽은 DOM에 렌더링 될 HTML만 필요로 하며, ref 같은 객체는 필요로 하지 않는다.\n<ul>\n<li>함수를 구현할때도 부모 컴포넌트는 자식의 상태를 알지 못하고 함수만 내려줄 뿐이다.</li>\n<li>ref 객체도 props와 비슷하게 전달한다. ref는 props와는 다르게 key의 속성과 비슷하다.\n<ul>\n<li>key는 컴포넌트의 속성으로 작성해도 내려가지 않는다.</li>\n</ul>\n</li>\n<li>ref는 <code class=\"language-text\">React.forwardRef()</code>를 통해 하위 컴포넌트로 전달 할 수 있다.</li>\n</ul>\n</li>\n</ul>\n<h3>2. 재사용성이 높은 컴포넌트인 “NormalGridList” 컴포넌트에 ref를 전달하고 싶은데 왜 에러..?</h3>\n<ul>\n<li>\n<p>이 컴포넌트를 호출하는 컴포넌트에서 ref를 전달하려했더니 에러.<br>\n(<strong>부모 컴포넌트로부터 하위 컴포넌트로 ref를 전달하려할 때 발생</strong>)</p>\n<ul>\n<li>\n<p><code class=\"language-text\">forwardRef</code>를 사용하라는 에러메세지가 발생</p>\n</li>\n<li>\n<p>왜 발생하는걸까? (난 함수형 컴포넌트만을 사용하여 작업한다. 알아보니..)</p>\n<ul>\n<li><strong>“함수형 컴포넌트”는 애초에 ref 가 존재하지 않는다!!! 😭</strong></li>\n<li>“클래스형 컴포넌트”의 경우 ref 객체는 마운트된 컴포넌트의 인스턴스를 <em>current</em> 프로퍼티 값으로서 받는다.</li>\n<li>참고 이미지 (<a href=\"https://ko.reactjs.org/docs/refs-and-the-dom.html\" target=\"_blank\" rel=\"nofollow\">React 공식 : Ref와 DOM</a>)</li>\n</ul>\n<blockquote>\n<p>이러한 경우 때문에 <code class=\"language-text\">forwardRef</code> 를 사용하라는 것 같다!</p>\n</blockquote>\n</li>\n</ul>\n</li>\n<li>\n<p><code class=\"language-text\">forwardRef</code>?</p>\n<ul>\n<li>일부 컴포넌트에서 생성한 <u>ref</u>를 조금 더 아래로 전달(전송)할 수 있는 옵트인 기능</li>\n<li><code class=\"language-text\">forwardRef</code>를 사용하면 부모 컴포넌트로부터 하위 컴포넌트로 <u>ref</u>를 전달할 수 있음!</li>\n<li>전달받은 ref를 HTML 요소의 속성으로 넘겨줌으로써 함수 컴포넌트 역시 <u>ref</u>를 통한 제어가 가능!</li>\n</ul>\n</li>\n<li>\n<p>“NormalGridList” 컴포넌트 리팩토링</p>\n<ul>\n<li>\n<p>예전 코드</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> FunctionComponent <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">as</span> <span class=\"token constant\">S</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./style'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> NormalGridList<span class=\"token operator\">:</span> <span class=\"token function-variable function\">FunctionComponent</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> children<span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span>props <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">S.NormalGridListLayout</span></span> <span class=\"token spread\"><span class=\"token punctuation\">{</span><span class=\"token operator\">...</span>props<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span>children<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">S.NormalGridListLayout</span></span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> NormalGridList<span class=\"token punctuation\">;</span></code></pre></div>\n</li>\n<li>\n<p>리팩토링</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> forwardRef <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">as</span> <span class=\"token constant\">S</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./style'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">type</span> <span class=\"token class-name\">NormalGridListProps</span> <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span>HTMLProps<span class=\"token operator\">&lt;</span>HTMLUListElement<span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> NormalGridList <span class=\"token operator\">=</span> <span class=\"token generic-function\"><span class=\"token function\">forwardRef</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span>HTMLUListElement<span class=\"token punctuation\">,</span> NormalGridListProps<span class=\"token operator\">></span></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">,</span> ref<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">S.NormalGridListLayout</span></span> <span class=\"token spread\"><span class=\"token punctuation\">{</span><span class=\"token operator\">...</span><span class=\"token punctuation\">{</span> props <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">ref</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>ref<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>children<span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">S.NormalGridListLayout</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> NormalGridList<span class=\"token punctuation\">;</span></code></pre></div>\n<ul>\n<li>타입스크립트를 사용하다보니 또 해맸다. forwardRef로 감싸서 컴포넌트 리턴하지만 props가 계속 받아지지 않는 현상이 있었다.\n<ul>\n<li>당시 <code class=\"language-text\">forwardRef&lt;HTMLUListElement></code> 이렇게만 사용했었는데 알아보니 <code class=\"language-text\">forwardRef</code>의 제네릭의 두번째 인자로 Prop의 타입이 들어가야 원활히 동작한다!</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p>리팩토링 (추가)</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> forwardRef <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">as</span> <span class=\"token constant\">S</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./style'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">type</span> <span class=\"token class-name\">NormalGridListProps</span> <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span>HTMLAttributes<span class=\"token operator\">&lt;</span>HTMLUListElement<span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> NormalGridList <span class=\"token operator\">=</span> <span class=\"token generic-function\"><span class=\"token function\">forwardRef</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span>HTMLUListElement<span class=\"token punctuation\">,</span> NormalGridListProps<span class=\"token operator\">></span></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">,</span> ref<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">S.NormalGridListLayout</span></span> <span class=\"token spread\"><span class=\"token punctuation\">{</span><span class=\"token operator\">...</span>props<span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">ref</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>ref<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>children<span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">S.NormalGridListLayout</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> NormalGridList<span class=\"token punctuation\">;</span></code></pre></div>\n<ul>\n<li><code class=\"language-text\">NormalGridListProps</code> 는 <code class=\"language-text\">React.HTMLProps&lt;HTMLUListElement></code> 으로<br>\n설정되어있었는데, 이렇게하면 <code class=\"language-text\">{...props}</code>를 제대로 전달하지 못하는 현상이 있다..</li>\n<li><code class=\"language-text\">HTMLProps</code> 가 아닌 <strong><code class=\"language-text\">HTMLAttributes</code></strong> 로 변경하여 적용하였더니 해결됨!</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<br/>\n<blockquote>\n<p>이렇게 리팩토링하였지만.. 쓸 필요가 갑자기 없어졌지. 다음에 한번 써보기위해서 메모!</p>\n</blockquote>\n<hr>\n<p><strong>참고자료</strong></p>\n<ul>\n<li>React\n<ul>\n<li><a href=\"https://ko.reactjs.org/docs/refs-and-the-dom.html\" target=\"_blank\" rel=\"nofollow\">React 공식 : Ref와 DOM</a></li>\n<li><a href=\"https://ko.reactjs.org/docs/forwarding-refs.html\" target=\"_blank\" rel=\"nofollow\">React 공식 : Forwarding Refs</a></li>\n<li><a href=\"https://stackoverflow.com/questions/54654303/using-a-forwardref-component-with-children-in-typescript\" target=\"_blank\" rel=\"nofollow\">Using a forwardRef component with children in TypeScript</a></li>\n<li><a href=\"https://www.carlrippon.com/react-forwardref-typescript/\" target=\"_blank\" rel=\"nofollow\">Forwarding React Refs with TypeScript</a></li>\n<li><a href=\"https://jooonho.com/react/2020-09-20-refForwarding/\" target=\"_blank\" rel=\"nofollow\">Ref Forwarding</a></li>\n</ul>\n</li>\n</ul>","frontmatter":{"title":"forwardRef가 뭘까?","summary":null,"date":"2021.11.15.","categories":["JavaScript","React"],"options":null,"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAACWklEQVQ4y71U/UtTURi+/4Akui+3+7Wdu+ZWy9bG2u62dtvUbTqHYtgHDsTCjz40Gy41RVYoWSZh3yFYYkEgEUER1I/9Hf0rT9xz55yu6aLwh8P54JznfZ73ed/D2Gw2/M/BHAqg1WrV1pIEGyE7eyLRoe5LZwcBbl9UZ96gg2Bu0oBtNvBGA3iTcXfQ/QBLYKIIYrfD1zcAdyxJgUSeg6f7Ak6me+m6GmilZEIgNJkQGBxDeGwWoRszCA7lEB6fQ+DKTUSn7qMl1Q3BbKJ3D2YoSRBZC+SrtylTS30dMu9+IH7vGXQMg+NKO/zZYXD6RqpiL0tmFxghEDmWSooVniCSKyCxsoHWxZdIPf0AZXYZscIq5JFJcIZGGnCv9DKGGphLjkKZXoJy5yHS618QzS/Ck+mjo21pDZ2vP+FMfgGR3F1IThesolBNsgaoMnB4vGAbjqBr/Svc8RQGfwE9Wz/hPZdF+/Ib6BkGvvMDkEfz4I16rZwqAFUzLGb4syMIXZtCSzKD9NpnnOq5hLNzj6gh8ugkEo83aR5VFe7WTvqm3BwNsCwHKssTbWl0vNhCcvU9MpvfEbg8Tt1VGXe8+oj4wnM0+4PUvF2FX2FKsRs4XQOCQ7fg9Mto9p1G18Y3JFbeFmvxIry9/WDr60DsR6u7XC5djRyZmIc7noQrpFCZam4l5zH4+4dpWmjuJKm2wlYBXaEolJkHCF2fBnE44AyENXcn5ovuirW13rYEkeMg8jztCKsgQGRZGkg9V/e1t17pIikx3plJ5Y/0V9/XH5jvB3Z4H+y/AP4G7dxrurGOCo4AAAAASUVORK5CYII="},"images":{"fallback":{"src":"/static/21d26a4780f401e4ed7d720f623e02a3/85ec4/background_react.png","srcSet":"/static/21d26a4780f401e4ed7d720f623e02a3/73ddd/background_react.png 157w,\n/static/21d26a4780f401e4ed7d720f623e02a3/296da/background_react.png 314w,\n/static/21d26a4780f401e4ed7d720f623e02a3/85ec4/background_react.png 627w","sizes":"(min-width: 627px) 627px, 100vw"},"sources":[{"srcSet":"/static/21d26a4780f401e4ed7d720f623e02a3/41b82/background_react.webp 157w,\n/static/21d26a4780f401e4ed7d720f623e02a3/0a8ac/background_react.webp 314w,\n/static/21d26a4780f401e4ed7d720f623e02a3/58f07/background_react.webp 627w","type":"image/webp","sizes":"(min-width: 627px) 627px, 100vw"}]},"width":627,"height":627}},"publicURL":"/static/21d26a4780f401e4ed7d720f623e02a3/background_react.png"}}}}]}},"pageContext":{"slug":"/2021/2021-11-15_React_forwardRef/"}},
    "staticQueryHashes": ["1479751003","1642645631","3590156278","363963755","3949884163","77750267","884297919"]}