{"componentChunkName":"component---src-pages-custom-post-tsx","path":"/posts/2021/2021-05-11-[TechArticle]_DeepCopy_ShallowCopy/","result":{"data":{"allMarkdownRemark":{"edges":[{"node":{"id":"f379abe2-054a-589e-8e7f-f7ffc39a8939","fields":{"slug":"/2021/2021-05-11-[TechArticle]_DeepCopy_ShallowCopy/"},"html":"<h1>기술 문서 읽기 챌린지 [2021년 5월 11일]</h1>\n<h2><strong>깊은 복사와 얕은 복사에 대한 심도있는 이야기</strong></h2>\n<p><strong>1. Array.prototype.slice</strong></p>\n<ul>\n<li>주로 배열을 깔끔하게 복사할 때 사용할 수 있음.<br>\n<code class=\"language-text\">Array.prototype.slice</code>는 start 부터 end 까지 대상 배열에서 꺼내서<br>\n새로운 배열을 만들어 값을 집어 넣음.<br>\nstart 와 end 가 주어지지 않으면 전체 배열을 복사함!</li>\n<li><code class=\"language-text\">Array.prototype.slice</code>는 <em>중첩 구조 복사를 제대로 수행할 수 없다</em> 는 단점이 있음.</li>\n<li><code class=\"language-text\">Array.prototype.slice</code>는 <strong>얕은 복사</strong>!</li>\n</ul>\n<p><strong>2. Spread Operator (펼침 연산자, 전개 연산자)</strong></p>\n<ul>\n<li>펼침 연산자(Spread Operator)의 등장으로 값의 복사가 전반적으로 매우 편리.</li>\n<li>펼침 연사자가 호출될 때, 내부적으로는 iterator-looping 액션을 수행.\n<ul>\n<li>예) 어떤 객체에 <code class=\"language-text\">[Symbol.iterator]</code> 프로퍼티가 존재한다면 이터러블하다고 할 수 있고 반복문을 돌릴 수 있음</li>\n</ul>\n</li>\n<li>만약 <code class=\"language-text\">const arr = [1, 2, 3];</code> -> <code class=\"language-text\">const arrSpread = [...arr];</code> 이렇게 펼침 연산자를 사용한다면\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">(</span><span class=\"token function\">Typeof</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">)</span> is Iterable<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">throw</span> TypeError\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">var</span> a <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> b<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span> i <span class=\"token operator\">+=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    a<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n이러한 형식으로 돌아간다. (이거보다 더 훨씬 많은 검사과정이 있겠지만..?)\n<ul>\n<li>펼침 연산자도 위와 같은 구조로 돌아가기에 <em>중첩 구조는 복사하지 못한다!</em></li>\n</ul>\n</li>\n</ul>\n<p><strong>3. Object.assign</strong></p>\n<ul>\n<li><code class=\"language-text\">Object.assign</code> 으로 객체를 복사는 불가능하다.</li>\n<li>코드 예시 (복사 불가능)\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> arr <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> copied <span class=\"token operator\">=</span> Object<span class=\"token punctuation\">.</span><span class=\"token function\">assign</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> arr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">checker</span><span class=\"token punctuation\">(</span>arr<span class=\"token punctuation\">,</span> copied<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// true</span>\ncopied<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">checker</span><span class=\"token punctuation\">(</span>arr<span class=\"token punctuation\">,</span> copied<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// true</span>\n<span class=\"token comment\">// ~~~~~~~</span>\n<span class=\"token comment\">// It should've been false</span></code></pre></div>\n</li>\n<li>심층 복제의 경우 <code class=\"language-text\">Object.assign ()</code>이 속성 값을 복사하기 때문에 대안을 사용해야 함.<br>\n소스 값이 개체에 대한 참조 인 경우 해당 참조 값만 복사함. (MDN의 Object.assign 번역)</li>\n</ul>\n<p><strong>4. JSON.parse &#x26; JSON.stringify</strong></p>\n<ul>\n<li><code class=\"language-text\">JSON.stringify</code> 는 중첩 구조를 복사할 수 없는 이터러블 순회를 해결할 수 있다.<br>\n(입력 값으로 넘어온 데이터를 문자로 변형을 시켜주는 메소드)</li>\n<li><code class=\"language-text\">JSON.parse</code> 는 <code class=\"language-text\">JSON.stringify</code>등으로 변형된 문자를 다시 원래 객체로 되돌려주는 역할을 함.</li>\n<li>코드 예시\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> arr <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> copied <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">parse</span><span class=\"token punctuation\">(</span><span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span>arr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">checker</span><span class=\"token punctuation\">(</span>arr<span class=\"token punctuation\">,</span> copied<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// true</span>\ncopied<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">checker</span><span class=\"token punctuation\">(</span>arr<span class=\"token punctuation\">,</span> copied<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// false</span></code></pre></div>\n<ul>\n<li>중첩구조 복사 역시 아주 깔끔하게 수행된 것을 볼 수 있다.<br>\n객체 순환을 통해 값을 옮겨담는 과정이 아닌, 문자열로 변경 후<br>\n그것을 다시 해석해 원본 객체로 변경하는 과정에서 자바스크립트의 문자열(string)타입이<br>\n불변성 형질의 띠는 immutable primitive type (원시타입)이기 때문.</li>\n</ul>\n</li>\n<li>코드 예시 - 예외 1 (<code class=\"language-text\">Date</code>)\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> obj <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">d</span><span class=\"token operator\">:</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> copied <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">parse</span><span class=\"token punctuation\">(</span><span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span>obj<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">checker</span><span class=\"token punctuation\">(</span>obj<span class=\"token punctuation\">,</span> copied<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// false</span>\n<span class=\"token comment\">// 웨.. 안같아?</span></code></pre></div>\n<ul>\n<li>Date 객체가 <code class=\"language-text\">JSON.stringify</code> 의 입력 값으로 전달되면 <code class=\"language-text\">JSON.stringify</code>는<br>\nDate 객체의 <code class=\"language-text\">toString</code> 메소드를 실행.<br>\n같은 시간 같은 날짜를 가리키는 데이터라고 해도 보여지는 방식이 달라졌기 때문에<br>\n두 값의 서로 다른 값으로 간주되는 것</li>\n</ul>\n</li>\n<li>코드 예시 - 예외 2 (ECMA2020의 <code class=\"language-text\">BigInt</code>)\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span><span class=\"token function\">BigInt</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// ~~~~~~~~~~~~~~</span>\n<span class=\"token comment\">// Uncaught TypeError</span>\n<span class=\"token comment\">// Do not know how to serialize a BigInt</span></code></pre></div>\n<ul>\n<li>BigInt의 경우 아예 오류 반환..</li>\n</ul>\n</li>\n<li><code class=\"language-text\"> Array.prototype.slice</code> 와 같은 예제에서 보여준 메소드들과는<br>\n다르게 <code class=\"language-text\">JSON.stringify</code> 는 무한 사이클을 갖는 구조를 받지 않음.\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> a <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\na<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> a<span class=\"token punctuation\">;</span>\n<span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// Uncaught TypeError</span>\n<span class=\"token comment\">// Converting circular structure to JSON</span></code></pre></div>\n<ul>\n<li>이 경우는 순회하지 않는 경우를 뜻하는 “acyclic” 이라는 단어가 아예 ECMA-262 명세서에 따로 언급되고 있음<br>\n함수 역시 <code class=\"language-text\">JSON.stringify</code> 가 <em>문자로 바꿀 수 없는 객체</em> 중 하나다.\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> arr <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> copied <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">parse</span><span class=\"token punctuation\">(</span><span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span>arr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">checker</span><span class=\"token punctuation\">(</span>arr<span class=\"token punctuation\">,</span> copied<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// false</span></code></pre></div>\n</li>\n</ul>\n</li>\n<li><code class=\"language-text\">JSON.stringify</code>는..\n<ul>\n<li>JSON 객체에 대한 명세서 따로 존재하는데, ECMA 에서 관리되고 있으며 번호는 404 를 부여받음.<br>\n그래서 ECMA-404 라고 통칭한다</li>\n<li>ECMA-404 (JSON 명세서)의  JSON 값으로 표현될 수 있는 종류.\n<ul>\n<li><code class=\"language-text\">Object</code>, <code class=\"language-text\">array</code>, <code class=\"language-text\">number</code>, <code class=\"language-text\">string</code>, <code class=\"language-text\">true</code>, <code class=\"language-text\">false</code>, <code class=\"language-text\">null</code></li>\n<li>JSON 값으로 판단될 수 있는건 ECMA-404 에 따르면 위 처럼 7 가지 종류만 포함<br>\n나머지는 JSON 으로 분류될 수 없기에 <code class=\"language-text\">JSON.stringify</code>로 제대로 변환이 안될 수 있다.<br>\n이에 관한 내용은 <strong>아래 기술문서를 보자</strong>!</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h3>느낀점</h3>\n<ul>\n<li>음.. 이터러블이랑 Object.assign을 알고나서 또 다시 읽는 것도 좋을 것 같다.\n또 알아야 할 것은 자바스크립트의 최신 기능들.\n그래도 더 확고히 복사에 대해 이해가 어느정도 되었고, 종은 문서였다.</li>\n</ul>\n<br/>\n<p><strong>참고 링크</strong></p>\n<ul>\n<li><a href=\"https://medium.com/watcha/%EA%B9%8A%EC%9D%80-%EB%B3%B5%EC%82%AC%EC%99%80-%EC%96%95%EC%9D%80-%EB%B3%B5%EC%82%AC%EC%97%90-%EB%8C%80%ED%95%9C-%EC%8B%AC%EB%8F%84%EC%9E%88%EB%8A%94-%EC%9D%B4%EC%95%BC%EA%B8%B0-2f7d797e008a\" target=\"_blank\" rel=\"nofollow\">깊은 복사와 얕은 복사에 대한 심도있는 이야기</a></li>\n</ul>","frontmatter":{"title":"[Tech Article] 깊은 복사와 얕은 복사에 대한 심도있는 이야기","summary":null,"date":"2021.05.11.","categories":["Tech Article"],"options":null,"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/2wBDAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/wgARCAAUABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAMJBf/EABYBAQEBAAAAAAAAAAAAAAAAAAAFBv/aAAwDAQACEAMQAAAB2O50c85u22RSUsTWIWB//8QAHBAAAgIDAQEAAAAAAAAAAAAAAgYDBAAFBwEQ/9oACAEBAAEFAnd0gS6qb0TSuYZ0NRka6Eusv0m4B8AcKMD+f//EABsRAAIDAQEBAAAAAAAAAAAAAAIDAQQFExAj/9oACAEDAQE/AcfAzNvMiK1qFatdNqxeBrFrEFKsqBRgNhldRhKH9Gc2Ez4lC4Nswk/f/8QAHhEAAgIBBQEAAAAAAAAAAAAAAQIDBBEFEBITISP/2gAIAQIBAT8Be1aj1DoaDNR4OyOyAT9VaNWgbAYBm5l0LcfFbxhkpv8A/8QAJxAAAgICAQMDBAMAAAAAAAAAAQIDBBESBRMUIRAiIwAGJDEyQVH/2gAIAQEABj8CoWZqFrkO+umosNTp9TxC8pPyOvuJCqoCv/ZbUDP0Fpt2l9A5s8ZakHdKFPtkrMq9K7CR5kkhb4SQrpk+lFa1oV7vH3DZqxyKzQW5DBLH28rrsa222wshHCkBXUggragf7butyUnN8O1fk0HKJPx8Mb0+o1ZaX4lmOzGjZlmd1jj2K4OdVUZwoCjZmdsDwNncl3P+sxLN+ySfRSyqxRt02AOjYI2XP8WwSMjzgn0//8QAGBABAQEBAQAAAAAAAAAAAAAAAREhABD/2gAIAQEAAT8hU55EphWg1NJFL0LnEFq7DoO8ACAToBYQuQN2dBnGuuOWIvE+IU1hgNEJAryvFeSLEiogmYYHAsXz/9oADAMBAAIAAwAAABBEwAD/xAAVEQEBAAAAAAAAAAAAAAAAAAABIP/aAAgBAwEBPxARJMY2HZAeCi//xAAWEQEBAQAAAAAAAAAAAAAAAAABESD/2gAIAQIBAT8QQPVIREiCgJeBx//EABkQAQADAQEAAAAAAAAAAAAAAAEAEBEhMf/aAAgBAQABPxBnsQHr/wAgMbpy9Ku4ZsDJFlYpJ8NO3jCHIfIuhgZ7rRESAkJajPZhyze0XTE8GBkZJ2WLlM//2Q=="},"images":{"fallback":{"src":"/static/82e255e22d8f11f3dc5ee1a69318a5a1/8938a/background_tech_article.jpg","srcSet":"/static/82e255e22d8f11f3dc5ee1a69318a5a1/936b0/background_tech_article.jpg 90w,\n/static/82e255e22d8f11f3dc5ee1a69318a5a1/55343/background_tech_article.jpg 180w,\n/static/82e255e22d8f11f3dc5ee1a69318a5a1/8938a/background_tech_article.jpg 360w","sizes":"(min-width: 360px) 360px, 100vw"},"sources":[{"srcSet":"/static/82e255e22d8f11f3dc5ee1a69318a5a1/be9e0/background_tech_article.webp 90w,\n/static/82e255e22d8f11f3dc5ee1a69318a5a1/e8c26/background_tech_article.webp 180w,\n/static/82e255e22d8f11f3dc5ee1a69318a5a1/6d50c/background_tech_article.webp 360w","type":"image/webp","sizes":"(min-width: 360px) 360px, 100vw"}]},"width":360,"height":360}},"publicURL":"/static/82e255e22d8f11f3dc5ee1a69318a5a1/background_tech_article.jpg"}}}}]}},"pageContext":{"slug":"/2021/2021-05-11-[TechArticle]_DeepCopy_ShallowCopy/"}},"staticQueryHashes":["1642645631","2183628444","3096950251","3590156278","3949884163","77750267","884297919"]}